\documentclass[]{book}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={R Markdown Cookbook},
            pdfauthor={Michael Harper, Yihui Xie},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{natbib}
\bibliographystyle{apalike}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\newcommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}

  \title{R Markdown Cookbook}
    \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
    \author{Michael Harper, Yihui Xie}
    \preauthor{\centering\large\emph}
  \postauthor{\par}
      \predate{\centering\large\emph}
  \postdate{\par}
    \date{2018-09-23}

\usepackage{booktabs}

\usepackage{amsthm}
\newtheorem{theorem}{Theorem}[chapter]
\newtheorem{lemma}{Lemma}[chapter]
\theoremstyle{definition}
\newtheorem{definition}{Definition}[chapter]
\newtheorem{corollary}{Corollary}[chapter]
\newtheorem{proposition}{Proposition}[chapter]
\theoremstyle{definition}
\newtheorem{example}{Example}[chapter]
\theoremstyle{definition}
\newtheorem{exercise}{Exercise}[chapter]
\theoremstyle{remark}
\newtheorem*{remark}{Remark}
\newtheorem*{solution}{Solution}
\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\hypertarget{preface}{%
\chapter*{Preface}\label{preface}}
\addcontentsline{toc}{chapter}{Preface}

\begin{quote}
This book is in a \textbf{very} early stage of development. If you have
any suggestions on what should be included within this book, please get
in touch via
\href{https://github.com/mikey-harper/rmarkdown-cookbook}{GitHub}
\end{quote}

R Markdown is a powerful tool for combining analysis and reporting into
the same document. Since the development of the \textbf{rmarkdown}
package \citep{R-rmarkdown}, it has grown to become a diverse ecosystem
of code, and reports, books and websites can all easily be generated
directly from R code.

There is a wealth of guidance which has grown over the past few years.
\href{https://bookdown.org/yihui/rmarkdown/}{\emph{R Markdown: The
Definitive Guide}} \citep{xie2018}. However, as noted by Yihui, it was
commented by the publisher that it would be beneficial to provide more
practical examples of the use of R Markdown. And so, the idea of this
book was born.

To fill the gap for official documentation, users often seek for help on
StackOverflow. At the time of writing, there were almost 4,000
\href{https://stackoverflow.com/questions/tagged/r-markdown}{different
questions} with the \texttt{r-markdown} tag. However, the use of the
website is relatively difficult if you do not have a specific problem
you are trying to search for, and therefore it is hard to be able to
tell what is possible with R Markdown unless you have the insight to
search for a specific question. This book aims to draw together much
existing literature from StackOverflow, and provide up-to-date solutions
for everyday queries that users commonly face.

This book is designed to provide a range of examples of how to extend
the functionality of your R Markdown documents. As a cookbook, this
guide is recommended to new or intermediate R Markdown users who are
looking for practical examples of how R Markdown documents can be
effectively updated.

\hypertarget{how-to-read-this-book}{%
\section*{How to read this book}\label{how-to-read-this-book}}
\addcontentsline{toc}{section}{How to read this book}

The book is designed to highlight the many ways in which your R Markdown
documents can be customized. Users are encouraged to try using the
concepts within their own documents. The code detailed in the book
should be sufficient, but the full source code and examples are provided
on \href{https://github.com/mikey-harper/rmarkdown-cookbook}{GitHub}.

It is recommended that readers have a basic understanding of R Markdown.
\href{https://bookdown.org/yihui/rmarkdown/basics.html}{Chapter 2} of
\href{https://bookdown.org/yihui/rmarkdown/}{\emph{R Markdown: The
Definitive Guide}} \citep{xie2018} provides a great overview of the
basics of R Markdown and is recommended background reading for any new
users of R Markdown.

It should be noted that this guide does not intend to provide a full
technical reference for R Markdown, and there is already extensive
literature available on these topics. This book aims to supplement, not
replace, this existing literature, and it is therefore recommended that
readers explore the following books if they seek further information:

\begin{itemize}
\tightlist
\item
  \emph{R Markdown: The Definitive guide} \citep{xie2018}: provides an
  overview of the R Markdown package and the wide range of ways it can
  be used.
\item
  \emph{Dynamic documents and knitr}: provides more detailed technical
  guidance on the inner workings of \textbf{rmarkdown} and
  \textbf{knitr} \citep{R-knitr}.
\item
  \emph{Authoring books with bookdown} \citep{xie2016bookdown}: a short
  book which provides details on the \textbf{bookdown} package
  \citep{R-bookdown}, which is designed to simplify the creation of
  long-format documents in R Markdown.
\item
  \emph{blogdown: Creating Websites with R Markdown}
  \citep{xie2017blogdown}: provides details of the \textbf{blogdown}
  package \citep{R-blogdown} package.
\end{itemize}

Where relevant, this book provides references to these existing
resources.

\hypertarget{structure-of-the-book}{%
\section*{Structure of the book}\label{structure-of-the-book}}
\addcontentsline{toc}{section}{Structure of the book}

The book is broken down into small ``recipes'' which aim to demonstrate
a single concept at a time.

Chapter content to be finalised once recipes created.

\hypertarget{software-info}{%
\section*{Software information and conventions}\label{software-info}}
\addcontentsline{toc}{section}{Software information and conventions}

The R session information used when compiling this book is as follows:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{xfun}\OperatorTok{::}\KeywordTok{session_info}\NormalTok{(}\KeywordTok{c}\NormalTok{(}
  \StringTok{'blogdown'}\NormalTok{, }\StringTok{'bookdown'}\NormalTok{, }\StringTok{'knitr'}\NormalTok{, }\StringTok{'rmarkdown'}\NormalTok{), }\DataTypeTok{dependencies =} \OtherTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## R version 3.5.0 (2018-04-23)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 17134)
## 
## Locale:
##   LC_COLLATE=English_United Kingdom.1252 
##   LC_CTYPE=English_United Kingdom.1252   
##   LC_MONETARY=English_United Kingdom.1252
##   LC_NUMERIC=C                           
##   LC_TIME=English_United Kingdom.1252    
## 
## Package version:
##   blogdown_0.8   bookdown_0.7   knitr_1.20     rmarkdown_1.10
\end{verbatim}

We do not add prompts (\texttt{\textgreater{}} and \texttt{+}) to R
source code in this book, and we comment out the text output with two
hashes \texttt{\#\#} by default, as you can see from the R session
information above. This is for your convenience when you want to copy
and run the code (the text output will be ignored since it is commented
out). Package names are in bold text (e.g., \textbf{rmarkdown}), and
inline code and filenames are formatted in a typewriter font (e.g.,
\texttt{knitr::knit(\textquotesingle{}foo.Rmd\textquotesingle{})}).
Function names are followed by parentheses (e.g.,
\texttt{blogdown::serve\_site()}). The double-colon operator \texttt{::}
means accessing an object from a package.

``Rmd'' is the filename extension of R Markdown files, and also an
abbreviation of R Markdown in this book.

\hypertarget{acknowledgements}{%
\section*{Acknowledgements}\label{acknowledgements}}
\addcontentsline{toc}{section}{Acknowledgements}

\hypertarget{author}{%
\chapter*{About the Authors}\label{author}}
\addcontentsline{toc}{chapter}{About the Authors}

\mainmatter

\hypertarget{part-get-started}{%
\part{Get Started}\label{part-get-started}}

\hypertarget{installation}{%
\chapter{Installation}\label{installation}}

We assume you have already installed R (\url{https://www.r-project.org})
\citep{R-base} and the RStudio IDE (\url{https://www.rstudio.com}).
RStudio is not required but recommended, because it makes it easier for
an average user to work with R Markdown. If you do not have RStudio IDE
installed, you will have to install Pandoc\index{Pandoc}
(\url{http://pandoc.org}), otherwise there is no need to install Pandoc
separately because RStudio has bundled it. Next you can install the
\textbf{rmarkdown} package in R:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Install from CRAN}
\KeywordTok{install.packages}\NormalTok{(}\StringTok{'rmarkdown'}\NormalTok{)}

\CommentTok{# Or if you want to test the development version,}
\CommentTok{# install from GitHub}
\ControlFlowTok{if}\NormalTok{ (}\OperatorTok{!}\KeywordTok{requireNamespace}\NormalTok{(}\StringTok{"devtools"}\NormalTok{))}
  \KeywordTok{install.packages}\NormalTok{(}\StringTok{'devtools'}\NormalTok{)}
\NormalTok{devtools}\OperatorTok{::}\KeywordTok{install_github}\NormalTok{(}\StringTok{'rstudio/rmarkdown'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{basics}{%
\chapter{Basics}\label{basics}}

This book by no means intends to be a comprehesive guide to R Markdown,
however before we start, it is important to provide an overview of the
key challenges which users often face when they attempt to customise
their R Markdown documents.

This chapter aims to clarify frequently confused concepts for users
wishing to extend

\hypertarget{r-markdown-components}{%
\section{R Markdown components}\label{r-markdown-components}}

A common source of confusion is understanding which component does what
within the R markdown worflow. Figure X highlights the components of the
R Markdown workflow.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{knitr}\OperatorTok{::}\KeywordTok{include_graphics}\NormalTok{(}\StringTok{"rmarkdownFlow.png"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{rmarkdownFlow.png}

We focus on \texttt{.Rmd} files within this book. \texttt{.Rnw} and
\texttt{.Rhtml} are available but less frequently used formats.

\textbf{knitr} is responsible for the first stage of the conversion
process. This processes all the embedded code chunks.

The conversion process used by \textbf{knitr} is output format
dependent.

\textbf{pandoc} is responsible for converting the raw markdown file into
the required output format (PDF/HTML/Word).

If PDF format is selected, there is one additonal dependency of LaTeX.

\hypertarget{basics-1}{%
\chapter{Basics}\label{basics-1}}

\begin{itemize}
\tightlist
\item
  What should be known before reading this book
\item
  Assumed knowledge of the basics of R Markdown
\end{itemize}

\hypertarget{quick-tips}{%
\section{Quick Tips}\label{quick-tips}}

\begin{itemize}
\item
  Short index of some basic ideas on how to improve R Markdown documents
\item
  Include current date in R Markdown
  \url{https://stackoverflow.com/questions/23449319/yaml-current-date-in-rmarkdown/23529410\#23529410}
\end{itemize}

\hypertarget{part-recipes}{%
\part{Recipes}\label{part-recipes}}

\hypertarget{document-elements}{%
\chapter{Document Elements}\label{document-elements}}

There are lots of small tips and tricks that can be used to customize
the content of R Markdown documents. This chapter provides short recipes
which are useful for tweaking the behaviour of your own R Markdown
documents.

\hypertarget{set-date-to-current-date}{%
\section{Set Date to Current Date}\label{set-date-to-current-date}}

It is useful for the date of the knitted R Markdown document to
automatically update each time we rerun the file. To do this, we can add
R code directly to the \texttt{date} field in the YAML, and use the
\texttt{Sys.time()} function to extract the current date. As this
function will by default provide the date and time, we must format it as
shown below:

\begin{Shaded}
\begin{Highlighting}[]
\OtherTok{---}
\FunctionTok{title:}\AttributeTok{ Your title}
\FunctionTok{date:}\AttributeTok{ }\StringTok{"23 September, 2018"}
\OtherTok{---}
\end{Highlighting}
\end{Shaded}

This will automatically update each time you Knit your document i.e.~23
September, 2018. If we wish to customize the format of the dates, we can
alter the time format by providing our own text string. A full table of
POSIXct formats is shown in Table @\ref(tab:dateTimeFormats), with some
complete examples shown below:

\begin{itemize}
\tightlist
\item
  \texttt{\%B\ \%Y}: ``September 2018''
\item
  \texttt{\%d/\%m/\%y}: ``23/09/18''
\item
  \texttt{\%d/\%m/\%y}: ``Sun 23 Sep''
\end{itemize}

\begin{table}

\caption{\label{tab:dateTimeFormats}Date Time Formats within R}
\centering
\begin{tabular}[t]{l|l|l|l}
\hline
Code & Meaning & Code & Meaning\\
\hline
\%a & Abbreviated weekday & \%A & Full weekday\\
\hline
\%b & Abbreviated month & \%B & Full month\\
\hline
\%c & Locale-specific date and time & \%d & Decimal date\\
\hline
\%H & Decimal hours (24 hour) & \%I & Decimal hours (12 hour)\\
\hline
\%j & Decimal day of the year & \%m & Decimal month\\
\hline
\%M & Decimal minute & \%p & Locale-specific AM/PM\\
\hline
\%S & Decimal second & \%U & Decimal week of the year (starting on Sunday)\\
\hline
\%w & Decimal Weekday (0=Sunday) & \%W & Decimal week of the year (starting on Monday)\\
\hline
\%x & Locale-specific Date & \%X & Locale-specific Time\\
\hline
\%y & 2-digit year & \%Y & 4-digit year\\
\hline
\%z & Offset from GMT & \%Z & Time zone (character)\\
\hline
\end{tabular}
\end{table}

\hypertarget{adding-multiple-authors}{%
\section{Adding Multiple Authors}\label{adding-multiple-authors}}

We can add multiple authors to a R Markdown document within the YAML.

\begin{Shaded}
\begin{Highlighting}[]
\OtherTok{---}
\FunctionTok{author:}\AttributeTok{ John Doe}
\OtherTok{---}
\end{Highlighting}
\end{Shaded}

\hypertarget{latex}{%
\chapter{LaTeX}\label{latex}}

For many authors, the main of long reports or books, the primary output
will be LaTeX. In this chapter, we discuss approaches which can be used
to customise the output of PDF reports.

Users should approach with a note of caution. One of the major benefits
of R Markdown is the fact that a single source document can create
documents with multiple formats. By tailoring your work to a single
output format (PDF/Word/HTML), you may improve the appearance and
performance of a single output but at the expense of this
tranferability.

\hypertarget{inserting-commands}{%
\section{Inserting Commands}\label{inserting-commands}}

\hypertarget{latex-preamble}{%
\section{LaTeX preamble}\label{latex-preamble}}

\hypertarget{multi-figure-plots}{%
\section{Multi-figure plots}\label{multi-figure-plots}}

If we need to print multiple output graphs or figures, there are several
ways this can be achieved.

\hypertarget{cross-output}{%
\section{Cross-output}\label{cross-output}}

As explained in
\url{https://bookdown.org/yihui/rmarkdown/r-code.html\#figures} of
\citet{xie2018}, we can place multiple figures side-by-side using the
\texttt{fig.hold=\textquotesingle{}hold\textquotesingle{}} along with
the \texttt{out.width} option. As an example below, we have set the
\texttt{out.width="50\%"}:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{10}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(}\KeywordTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{), }\DataTypeTok{pch=}\DecValTok{19}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\includegraphics[width=0.5\linewidth]{rmarkdown-cookbook_files/figure-latex/fig-sub-2-1} \includegraphics[width=0.5\linewidth]{rmarkdown-cookbook_files/figure-latex/fig-sub-2-2} \caption{Side-by-side figures}\label{fig:fig-sub-2}
\end{figure}

The main benefits of this approach is that it is easily achieved, and
also works for both PDF and HTML outputs.

\hypertarget{latex-subfigures}{%
\section{LaTeX subfigures}\label{latex-subfigures}}

When writing a document you may want to include some slightly more
complicated figures with multiple images. Subfigures are a useful LaTeX
feature which allows us to achieve this by plotting multiple figures
within a single plot and providing each with their own subcaption.

Subfigures require the LaTeX package \texttt{subfig}. The line
\texttt{\textbackslash{}usepackage\{subfig\}} must therefore be included
within the YAML, or if you are using an external tex template you can
add this to that file. For example:

As listed within the knitr
\href{https://yihui.name/knitr/options/}{chunk options}, subfigures
require a few additional settings to be set in the chunk header:

\begin{itemize}
\tightlist
\item
  \texttt{fig.subcap} is a list of the captions for subfigures
\item
  \texttt{fig.ncol}: the number of columns of subfigures
\item
  \texttt{out.width}: the output width of the figures. You will normally
  set this 100\% divided by the number of sub columns.
\end{itemize}

An example is demonstrated below:

\begin{verbatim}
```yaml
output: pdf_document
header-includes:
   - \usepackage{subfig}
```

```{r fig-sub, fig.cap='two plots', fig.subcap=c('one plot', 'the other one'), out.width='.49\\linewidth', fig.asp=1, fig.ncol = 2}
plot(1:10)
plot(rnorm(10), pch=19)
```
\end{verbatim}

The output is shown in Figure \ref{fig:subcaptions}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{knitr}\OperatorTok{::}\KeywordTok{include_graphics}\NormalTok{(}\StringTok{"images/subfigure.png"}\NormalTok{, }\DataTypeTok{dpi =} \OtherTok{NA}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{images/subfigure.png}
\caption{\label{fig:subcaptions}An example subcaption}
\end{figure}

\hypertarget{using-with-list}{%
\subsection{Using with list}\label{using-with-list}}

\hypertarget{html-output}{%
\chapter{HTML Output}\label{html-output}}

How to customise the appearance of HTML documents:

\begin{itemize}
\tightlist
\item
  CSS styles
\item
  Adapt some of the details from here:
  \url{https://rmarkdown.rstudio.com/html_document_format.html}
\end{itemize}

\hypertarget{tabbed-headings}{%
\section{Tabbed headings}\label{tabbed-headings}}

\url{https://stackoverflow.com/questions/38062706/rmarkdown-tabbed-and-untabbed-headings?utm_medium=organic\&utm_source=google_rich_qa\&utm_campaign=google_rich_qa}

\hypertarget{multi-format-projects}{%
\chapter{Multi-format projects}\label{multi-format-projects}}

One of the main benefits of R Markdown can create multiple output
formats from a single source document. This book example is available in
all three formats, with PDF, ebook and online versions all being
available.

Project should therefore ideally be designed to be flexible for the
multiple outputs. However, users will often find themselves wanting to
fine-tune the output, and doing so will often require

This chapter aims to provide several examples on how a document can be
customised with output specific features, whilst also retaining the
ability to export documents to multiple formats.

\hypertarget{control-output}{%
\section{Control Output}\label{control-output}}

Dsigning custom behavior which can respond to change in outputs using
\texttt{is\_latex\_output} etc. For example, you may want to have
interactive tables using \texttt{DT:datatable} in the HTML output but
print static versions in the PDF.

\hypertarget{output-specific-functions}{%
\section{Output-specific functions}\label{output-specific-functions}}

HTML documents have the capacity to contain. The webshot package is
available to take screenshots of HTML elements for non-interactive
output formats (ebooks, PDF).

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(ggplot2)}
\KeywordTok{library}\NormalTok{(plotly)}
\NormalTok{p <-}\StringTok{ }\KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =}\NormalTok{ diamonds, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ cut, }\DataTypeTok{fill =}\NormalTok{ clarity)) }\OperatorTok{+}
\StringTok{            }\KeywordTok{geom_bar}\NormalTok{(}\DataTypeTok{position =} \StringTok{"dodge"}\NormalTok{)}
\KeywordTok{ggplotly}\NormalTok{(p)}
\end{Highlighting}
\end{Shaded}

\hypertarget{designing-output}{%
\section{Designing output}\label{designing-output}}

If we wish to design our own format-specific function we can use the
functions
\texttt{knitr::is\_latex\_output()\ and}knitr::is\_html\_output`. These
function will return a TRUE/FALSE action

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{knitr}\OperatorTok{::}\KeywordTok{is_html_output}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

This can be used to control the output of statements.

\hypertarget{knitr-hooks}{%
\chapter{Knitr Hooks}\label{knitr-hooks}}

\begin{itemize}
\tightlist
\item
  Knitr hooks: these are explained within previous R Markdown book
\item
  Include practical examples could be very useful for readers to see the
  power of it.
\item
  Use some of these: \url{https://gist.github.com/yihui/2629886}
\end{itemize}

\hypertarget{tables}{%
\chapter{Tables}\label{tables}}

\begin{itemize}
\tightlist
\item
  provide more detailed documentation on kable
\item
  Using kableExtra to style tables
\end{itemize}

\hypertarget{managing-big-projects}{%
\chapter{Managing Big Projects}\label{managing-big-projects}}

\begin{itemize}
\tightlist
\item
  Practical tips on how a big project should be managed
\item
  \texttt{source} is particularly useful for loading external scripts so
  that the R Markdown project isn't too bloated with code.
\end{itemize}

\textbf{Ideas}: - Use \texttt{(ref:tag)} to store page formatting
options which might need to be reused. For example a page break

\hypertarget{sourcing-files}{%
\section{Sourcing Files}\label{sourcing-files}}

A benefit of using R Markdown is that it is easy

\begin{verbatim}
source("yourScript.R")
\end{verbatim}

\hypertarget{caching}{%
\section{Caching}\label{caching}}

\begin{itemize}
\tightlist
\item
  Caching
\item
  Ways it can be tailored to suit analysis. This cache invalidation is a
  great example:
  \url{https://stackoverflow.com/questions/18376008/invalidate-a-chunks-cache-when-uncached-chunk-changes}
\end{itemize}

\hypertarget{notifications}{%
\section{Notifications}\label{notifications}}

\begin{itemize}
\tightlist
\item
  Can link R Markdown with notifications if have long analysis
\end{itemize}

\begin{itemize}
\tightlist
\item
  Working with non R users
\item
  Use HTML outputs and interactive graphics
\end{itemize}

\hypertarget{part-additional-packages}{%
\part{Additional Packages}\label{part-additional-packages}}

\hypertarget{diagrams}{%
\chapter{Diagrams}\label{diagrams}}

It is often useful to express analysis using flowcharts and diagrams
within reports. Although there are many separate programs which can be
used to produce these, it can be beneficial to create these within our
analysis directly. This makes it easier to update and edit the graph if
we need to edit it in the future, and allows us to use the results from
our analysis directly within the diagrams, making them more information.

While there are several different packages available for R, we will
focus on the package \textbf{DiagrammeR} \citep{R-DiagrammeR}. We also
recommend that you read at
\url{http://rich-iannone.github.io/DiagrammeR/index.html} . In this
chapter we will explain some of the basic usages of the package.

\hypertarget{basic-diagrams}{%
\section{Basic Diagrams}\label{basic-diagrams}}

\textbf{DiagrammeR} provides methods to build graphs for a number of
different graphing languages.

R Studio provides native support for Graphviz (\texttt{.gv}) and mermaid
(\texttt{.mmd}) files. Using files of these types in RStudio provides
the advantage of syntax coloring and allowing a quick preview of the
diagram. For example, we can make a simple flowchart with the following
code:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{DiagrammeR}\OperatorTok{::}\KeywordTok{grViz}\NormalTok{(}\StringTok{"digraph \{}

\StringTok{        graph [layout = dot, rankdir = LR]}
\StringTok{        }
\StringTok{        node [shape = rectangle]        }
\StringTok{        rec1 [label = 'Step 1']}
\StringTok{        rec2 [label = 'Step 2']}
\StringTok{        rec3 [label =  'Step 3']}
\StringTok{        rec4 [label = 'Step 4']}

\StringTok{        # edge definitions with the node IDs}
\StringTok{        rec1 -> rec2 -> rec3 -> rec4}
\StringTok{        \}"}\NormalTok{,}
        \DataTypeTok{height =} \DecValTok{200}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{rmarkdown-cookbook_files/figure-latex/diagrammeR-basic-1} 

}

\caption{A basic graphic using DiagrammeR}\label{fig:diagrammeR-basic}
\end{figure}

There are extensive controls which can be used to control the shape of
nodes, colours, line types and add additional parameters.

\hypertarget{adding-parameters-to-plots}{%
\section{Adding parameters to plots}\label{adding-parameters-to-plots}}

We can allow

Graphviz substitution allows for mixing in R expressions into a Graphviz
graph specification without sacrificing readability.

If you specify a subsitution with \texttt{@@}, you must ensure there is
a valid expression for that substitution. The expressions are placed as
footnotes and their evaluations must result in an R vector object (i.e.,
not a data frame, list, or matrix). Because there is the possibility to
have multiple substitutions, numbering is required. Thus, the @@
notation is immediately followed by a number and that number should
correspond to the number of the footnoted R expression.

For example, suppose we have a dataset which is being analysed, and we
would like to identify how many values are removed at each stage of a
process.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{DiagrammeR}\OperatorTok{::}\KeywordTok{grViz}\NormalTok{(}\StringTok{"}
\StringTok{digraph graph2 \{}

\StringTok{graph [layout = dot, rankdir = LR]}

\StringTok{# node definitions with substituted label text}
\StringTok{node [shape = rectangle]}
\StringTok{a [label = '@@1']}
\StringTok{b [label = '@@2']}
\StringTok{c [label = '@@3']}
\StringTok{d [label = '@@4']}

\StringTok{a -> b -> c -> d}

\StringTok{\}}

\StringTok{[1]: paste('Input Data', 1)}
\StringTok{[2]: paste('Step ', 1)}
\StringTok{[3]: paste('Step ', 1)}
\StringTok{[4]: paste('Step ', 1)}
\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{rmarkdown-cookbook_files/figure-latex/diagramme-parameters-1.pdf}

\hypertarget{altering-citation-style}{%
\section{Altering Citation Style}\label{altering-citation-style}}

\begin{itemize}
\tightlist
\item
  Using short author citations:
  \url{https://stackoverflow.com/questions/48303890/using-short-author-citations-in-bookdown-rmarkdown?utm_medium=organic\&utm_source=google_rich_qa\&utm_campaign=google_rich_qa}
\end{itemize}

\hypertarget{automatically-generate-package-citations}{%
\section{Automatically Generate Package
Citations}\label{automatically-generate-package-citations}}

It is important to that an acknowledgements is provided within your work
to authors of any literature or software referenced. Within a typical
workflow, this can be a frustrating experience if you are required to
manually identify the correctly formatted citations, load them into a
referencing software and then refer to them within the text. However, R
Markdown makes it easy to streamline this process.

We can generate a BibTex file for packages used within your analysis
using the \texttt{write\_bib} function within R Markdown.

\begin{verbatim}
# automatically create a bib database for R packages
knitr::write_bib(c(
  .packages(), 'bookdown', 'knitr', 'rmarkdown', 'DiagrammeR'
), 'packages.bib')
\end{verbatim}

Once the bibliography has been generated, we can reference the packages,
we can reference the package directly from within the text by

\begin{Shaded}
\begin{Highlighting}[]
\OtherTok{---}
\FunctionTok{bibliography:}\AttributeTok{ packages.bib}
\OtherTok{---}
\end{Highlighting}
\end{Shaded}

rmarkdown

If in addition to your packages

\begin{Shaded}
\begin{Highlighting}[]
\OtherTok{---}
\FunctionTok{bibliography:}\AttributeTok{ }\KeywordTok{[}\NormalTok{packages.bib. references.bib}\KeywordTok{]}
\OtherTok{---}
\end{Highlighting}
\end{Shaded}

A complete example of the elements above is provided below:

\hypertarget{references}{%
\chapter{References}\label{references}}

\bibliography{book.bib,packages.bib}


\end{document}
